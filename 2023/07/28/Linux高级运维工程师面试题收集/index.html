

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="1、Linux开机启动流程详细步骤是什么？启动第一步——加载BIOS：当你打开计算机电源，计算机会首先加载BIOS信息，BIOS信息是如此的重要，以至于计算机必须在最开始就找到它。这是因为BIOS中包含了CPU的相关信息、设备启动顺序信息、硬盘信息、内存信息、时钟信息、PnP特性等等。在此之后，计算机心里就有谱了，知道应该去读取哪个硬件设备了。 启动第二步——读取MBR：众所周知，硬盘上第0磁道第">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux高级运维工程师面试题收集">
<meta property="og:url" content="http://example.com/2023/07/28/Linux%E9%AB%98%E7%BA%A7%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/index.html">
<meta property="og:site_name" content="Mgedu-N80054">
<meta property="og:description" content="1、Linux开机启动流程详细步骤是什么？启动第一步——加载BIOS：当你打开计算机电源，计算机会首先加载BIOS信息，BIOS信息是如此的重要，以至于计算机必须在最开始就找到它。这是因为BIOS中包含了CPU的相关信息、设备启动顺序信息、硬盘信息、内存信息、时钟信息、PnP特性等等。在此之后，计算机心里就有谱了，知道应该去读取哪个硬件设备了。 启动第二步——读取MBR：众所周知，硬盘上第0磁道第">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-07-28T21:51:01.000Z">
<meta property="article:modified_time" content="2023-07-30T21:21:40.974Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>Linux高级运维工程师面试题收集 - Mgedu-N80054</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>JohnBackus</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Linux高级运维工程师面试题收集">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-07-28 21:51" pubdate>
        July 28, 2023 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      9.9k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      83 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Linux高级运维工程师面试题收集</h1>
            
            <div class="markdown-body">
              <h2 id="1、Linux开机启动流程详细步骤是什么？"><a href="#1、Linux开机启动流程详细步骤是什么？" class="headerlink" title="1、Linux开机启动流程详细步骤是什么？"></a>1、Linux开机启动流程详细步骤是什么？</h2><p><strong>启动第一步——加载BIOS：</strong>当你打开计算机电源，计算机会首先加载BIOS信息，BIOS信息是如此的重要，以至于计算机必须在最开始就找到它。这是因为BIOS中包含了CPU的相关信息、设备启动顺序信息、硬盘信息、内存信息、时钟信息、PnP特性等等。在此之后，计算机心里就有谱了，知道应该去读取哪个硬件设备了。</p>
<p><strong>启动第二步——读取MBR：</strong>众所周知，硬盘上第0磁道第一个扇区被称为MBR，也就是Master Boot Record，即主引导记录，它的大小是512字节，别看地方不大，可里面却存放了预启动信息、分区表信息。系统找到BIOS所指定的硬盘的MBR后，就会将其复制到0×7c00地址所在的物理内存中。其实被复制到物理内存的内容就是Boot Loader，而具体到你的电脑，那就是lilo或者grub了。</p>
<p><strong>启动第三步——Boot Loader：</strong>Boot Loader 就是在操作系统内核运行之前运行的一段小程序。通过这段小程序，我们可以初始化硬件设备、建立内存空间的映射图，从而将系统的软硬件环境带到一个合适的状态，以便为最终调用操作系统内核做好一切准备。Boot Loader有若干种，其中Grub、Lilo和spfdisk是常见的Loader。我们以Grub为例来讲解吧，毕竟用lilo和spfdisk的人并不多。系统读取内存中的grub配置信息（一般为menu.lst或grub.lst），并依照此配置信息来启动不同的操作系统。</p>
<p><strong>启动第四步——加载内核：</strong>根据grub设定的内核映像所在路径，系统读取内存映像，并进行解压缩操作。此时，屏幕一般会输出“Uncompressing Linux”的提示。当解压缩内核完成后，屏幕输出“OK, booting the kernel”。系统将解压后的内核放置在内存之中，并调用start_kernel()函数来启动一系列的初始化函数并初始化各种设备，完成Linux核心环境的建立。至此，Linux内核已经建立起来了，基于Linux的程序应该可以正常运行了。</p>
<p><strong>启动第五步－－用户层init依据inittab文件来设定运行等级：</strong>内核被加载后，第一个运行的程序便是/sbin/init，该文件会读取/etc/inittab文件，并依据此文件来进行初始化工作。其实/etc/inittab文件最主要的作用就是设定Linux的运行等级，其设定形式是“：id:5:initdefault:”，这就表明Linux需要运行在等级5上。Linux的运行等级设定如下：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">0</span>：关机<br><br><span class="hljs-number">1</span>：单用户模式<br><br><span class="hljs-number">2</span>：无网络支持的多用户模式<br><br><span class="hljs-number">3</span>：有网络支持的多用户模式<br><br><span class="hljs-number">4</span>：保留，未使用<br><br><span class="hljs-number">5</span>：有网络支持有X-Window支持的多用户模式<br><br><span class="hljs-number">6</span>：重新引导系统，即重启<br>关于<span class="hljs-regexp">/etc/i</span>nittab文件的学问，其实还有很多<br></code></pre></td></tr></table></figure>

<p><strong>启动第六步－－init进程执行rc.sysinit：</strong>在设定了运行等级后，Linux系统执行的第一个用户层文件就是/etc/rc.d/rc.sysinit脚本程序，它做的工作非常多，包括设定PATH、设定网络配置（/etc/sysconfig/network）、启动swap分区、设定/proc等等。如果你有兴趣，可以到/etc/rc.d中查看一下rc.sysinit文件，里面的脚本够你看几天的。</p>
<p><strong>启动第七步－－启动内核模块：</strong>具体是依据/etc/modules.conf文件或/etc/modules.d目录下的文件来装载内核模块。</p>
<p><strong>启动第八步－－执行不同运行级别的脚本程序：</strong>根据运行级别的不同，系统会运行rc0.d到rc6.d中的相应的脚本程序，来完成相应的初始化工作和启动相应的服务。</p>
<p><strong>启动第九步－－执行/etc/rc.d/rc.local：</strong>你如果打开了此文件，里面有一句话，读过之后，你就会对此命令的作用一目了然：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># This script will be executed *after* all the other init scripts.</span><br><span class="hljs-comment"># You can put your own initialization stuff in here if you don’t</span><br><span class="hljs-comment"># want to do the full Sys V style init stuff.</span><br></code></pre></td></tr></table></figure>

<p>rc.local就是在一切初始化工作后，Linux留给用户进行个性化的地方。你可以把你想设置和启动的东西放到这里。</p>
<p><strong>启动第十步－－执行/bin/login程序，进入登录状态：</strong>此时，系统已经进入到了等待用户输入username和password的时候了，你已经可以用自己的帐号登入系统了。</p>
<h2 id="2、Linux的管理员密码如何破解？"><a href="#2、Linux的管理员密码如何破解？" class="headerlink" title="2、Linux的管理员密码如何破解？"></a><strong>2、Linux的管理员密码如何破解？</strong></h2><p><strong>linux root密码找回方法一</strong></p>
<p><strong>第1步：</strong>在系统进入单用户状态，直接用passwd root去更改。</p>
<p><strong>第2步：</strong>用安装光盘引导系统，进行linux rescue状态，将原来/分区挂接上来,作法如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /mnt <span class="hljs-built_in">mkdir</span> hd mount -t auto /dev/hdaX(原来/分区所在的分区号) hd <span class="hljs-built_in">cd</span> hd <span class="hljs-built_in">chroot</span> ./ passwd root<br></code></pre></td></tr></table></figure>

<p><strong>第3步：</strong>将本机的硬盘拿下来，挂到其他的linux系统上，采用的办法与第二种相同.</p>
<p><strong>linux root密码找回方法二</strong></p>
<p><strong>第1步：</strong>用lilo引导系统时：在出现 lilo: 提示时键入 linux single</p>
<p>画面显示lilo: linux single</p>
<p><strong>第2步：</strong>回车可直接进入linux命令行</p>
<p><strong>第3步：</strong>使用以下命令“vi /etc/shadow”将第一行，即以root开头的一行中root:后和下一个:前的内容删除，第一行将类似于root::……保存</p>
<p>vim /etc/shadow</p>
<p><strong>第4步：</strong>reboot重启，root密码为空。</p>
<p><strong>linux root密码找回方法三</strong></p>
<p><strong>第1步：</strong>用grub引导系统时：在出现grub画面时，用上下键选中你平时启动linux的那一项(别选dos哟)，然后按e键</p>
<p><strong>第2步：</strong>再次用上下键选中你平时启动linux的那一项(类似于kernel /boot/vmlinuz-2.4.18-14 ro root=LABEL=/)，然后按e键</p>
<p><strong>第3步：</strong>修改你现在见到的命令行，加入single，结果如下：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">kernel</span> /boot/vmlinuz-<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">18</span>-<span class="hljs-number">14</span> single ro root=LABEL=/ single<br></code></pre></td></tr></table></figure>

<p><strong>第4步：</strong>回车返回，然后按b键启动，即可直接进入linux命令行.</p>
<p><strong>第5步：</strong>使用以下命令“vi /etc/shadow”将第一行，即以root开头的一行中root:后和下一个:前的内容删除，第一行将类似于root::……保存<br>vim /etc/shadow</p>
<p><strong>第6步：</strong>reboot重启，root密码为空。</p>
<h2 id="3、请描述Linux系统优化的几个步骤。"><a href="#3、请描述Linux系统优化的几个步骤。" class="headerlink" title="3、请描述Linux系统优化的几个步骤。"></a><strong>3、请描述Linux系统优化的几个步骤。</strong></h2><p>1、登录系统:不使用root登录，通过sudo授权管理，使用普通用户登录。</p>
<p>2、禁止SSH远程：更改默认的远程连接SSH服务及禁止root远程连接。</p>
<p>3、时间同步：定时自动更新服务器时间。</p>
<p>4、配置yum更新源，从国内更新下载安装rpm包。</p>
<p>5、关闭selinux及iptables（iptables工作场景如有wan ip，一般要打开，高并发除外）</p>
<p>6、调整文件描述符数量，进程及文件的打开都会消耗文件描述符。</p>
<p>7、定时自动清理/var/spool/clientmquene/目录垃圾文件，防止节点被占满（c6.4默认没有sendmail，因此可以不配。）</p>
<p>8、精简开机启动服务（crond、sshd、network、rsyslog）</p>
<p>9、Linux内核参数优化/etc/sysctl.conf，执行sysct -p生效。</p>
<p>10、更改字符集，支持中文，但是还是建议使用英文，防止乱码问题出现。</p>
<p>11、锁定关键系统文件（chattr +i /etc/passwd /etc/shadow /etc/group /etc/gshadow /etc/inittab 处理以上内容后，把chatter改名，就更安全了。）</p>
<p>12、清空/etc/issue，去除系统及内核版本登陆前的屏幕显示。</p>
<h2 id="4、描述Linux运行级别0-6的各自含义"><a href="#4、描述Linux运行级别0-6的各自含义" class="headerlink" title="4、描述Linux运行级别0-6的各自含义"></a>4、描述Linux运行级别0-6的各自含义</h2><p>0：关机模式</p>
<p>1：单用户模式&lt;==破解root密码</p>
<p>2：无网络支持的多用户模式</p>
<p>3：有网络支持的多用户模式（文本模式，工作中最常用的模式）</p>
<p>4：保留，未使用</p>
<p>5：有网络支持的X-windows支持多用户模式（桌面）</p>
<p>6: 重新引导系统，即重启</p>
<h2 id="5、Linux如何挂在windows下的共享目录"><a href="#5、Linux如何挂在windows下的共享目录" class="headerlink" title="5、Linux如何挂在windows下的共享目录"></a><strong>5、Linux如何挂在windows下的共享目录</strong></h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">mount.cifs <span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">1.3</span><span class="hljs-regexp">/server /m</span>nt/server -o user=administrator,pass=<span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure>

<p>Linux 下的server需要自己手动建一个 后面的user与pass 是windows主机的账号和密码 注意空格 和逗号。</p>
<h2 id="6、查看http的并发请求数与其TCP连接状态"><a href="#6、查看http的并发请求数与其TCP连接状态" class="headerlink" title="6、查看http的并发请求数与其TCP连接状态"></a><strong>6、查看http的并发请求数与其TCP连接状态</strong></h2><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos">netstat -n | awk &#x27;/<span class="hljs-symbol">^tcp</span>/ &#123;++b[<span class="hljs-built_in">$NF</span>]&#125; END &#123;<span class="hljs-keyword">for</span>(a in b) <span class="hljs-keyword">print</span> a, b[a]&#125;&#x27;<br></code></pre></td></tr></table></figure>

<p>还有ulimit -n 查看linux系统打开最大的文件描述符，这里默认1024，不修改这里web服务器修改再大也没用。若要用就修改很几个办法，这里说其中一个：</p>
<p>修改/etc/security/limits.conf</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-bullet">* </span>soft nofile 10240<br><span class="hljs-bullet">* </span>hard nofile 10240<br></code></pre></td></tr></table></figure>

<h2 id="7、用tcpdump嗅探80端口的访问看看谁最高"><a href="#7、用tcpdump嗅探80端口的访问看看谁最高" class="headerlink" title="7、用tcpdump嗅探80端口的访问看看谁最高"></a><strong>7、用tcpdump嗅探80端口的访问看看谁最高</strong></h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tcpdump</span> -i eth0 -tnn dst port <span class="hljs-number">80</span> -c <span class="hljs-number">1000</span> | awk -F<span class="hljs-string">&quot;.&quot;</span> &#x27;&#123;print $<span class="hljs-number">1</span><span class="hljs-string">&quot;.&quot;</span>$<span class="hljs-number">2</span><span class="hljs-string">&quot;.&quot;</span>$<span class="hljs-number">3</span><span class="hljs-string">&quot;.&quot;</span>$<span class="hljs-number">4</span>&#125;&#x27; | sort | uniq -c | sort -nr |head -<span class="hljs-number">5</span>&amp;nbsp;<br></code></pre></td></tr></table></figure>

<h2 id="8、查看-var-log目录下文件数"><a href="#8、查看-var-log目录下文件数" class="headerlink" title="8、查看/var/log目录下文件数"></a><strong>8、查看/var/log目录下文件数</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> /var/log/ -lR| grep <span class="hljs-string">&quot;^-&quot;</span> |<span class="hljs-built_in">wc</span> -l<br></code></pre></td></tr></table></figure>

<h2 id="9、查看当前系统每个IP的连接数"><a href="#9、查看当前系统每个IP的连接数" class="headerlink" title="9、查看当前系统每个IP的连接数"></a><strong>9、查看当前系统每个IP的连接数</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -n | awk <span class="hljs-string">&#x27;/^tcp/ &#123;print $5&#125;&#x27;</span>| awk -F: <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -rn<br></code></pre></td></tr></table></figure>

<h2 id="10、shell下32位随机密码生成"><a href="#10、shell下32位随机密码生成" class="headerlink" title="10、shell下32位随机密码生成"></a><strong>10、shell下32位随机密码生成</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /dev/urandom | <span class="hljs-built_in">head</span> -1 | <span class="hljs-built_in">md5sum</span> | <span class="hljs-built_in">head</span> -c 32 &gt;&gt; /pass<br></code></pre></td></tr></table></figure>

<p>将生成的32位随机数 保存到/pass文件里了</p>
<h2 id="11、统计出apache的access-log中访问量最多的5个IP"><a href="#11、统计出apache的access-log中访问量最多的5个IP" class="headerlink" title="11、统计出apache的access.log中访问量最多的5个IP"></a><strong>11、统计出apache的access.log中访问量最多的5个IP</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> access_log | awk  <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -n -r | <span class="hljs-built_in">head</span> -5<br></code></pre></td></tr></table></figure>

<h2 id="12、如何查看二进制文件的内容"><a href="#12、如何查看二进制文件的内容" class="headerlink" title="12、如何查看二进制文件的内容"></a><strong>12、如何查看二进制文件的内容</strong></h2><p>我们一般通过hexdump命令 来查看二进制文件的内容。</p>
<p>hexdump -C XXX(文件名) -C是参数 不同的参数有不同的意义</p>
<p>-C  是比较规范的 十六进制和ASCII码显示</p>
<p>-c  是单字节字符显示</p>
<p>-b  单字节八进制显示</p>
<p>-o  是双字节八进制显示</p>
<p>-d  是双字节十进制显示</p>
<p>-x  是双字节十六进制显示</p>
<p>等等等等</p>
<h2 id="13、ps-aux-中的VSZ代表什么意思，RSS代表什么意思"><a href="#13、ps-aux-中的VSZ代表什么意思，RSS代表什么意思" class="headerlink" title="13、ps aux 中的VSZ代表什么意思，RSS代表什么意思"></a><strong>13、ps aux 中的VSZ代表什么意思，RSS代表什么意思</strong></h2><p>VSZ:虚拟内存集,进程占用的虚拟内存空间</p>
<p>RSS:物理内存集,进程战用实际物理内存空间</p>
<h2 id="14、检测并修复-dev-hda5"><a href="#14、检测并修复-dev-hda5" class="headerlink" title="14、检测并修复/dev/hda5"></a>14、<strong>检测并修复/dev/hda5</strong></h2><p>fsck用来检查和维护不一致的文件系统。若系统掉电或磁盘发生问题，可利用fsck命令对文件系统进行检查,</p>
<h2 id="15、符号链接与硬链接的区别"><a href="#15、符号链接与硬链接的区别" class="headerlink" title="15、符号链接与硬链接的区别"></a><strong>15、符号链接与硬链接的区别</strong></h2><p>我们可以把符号链接，也就是软连接 当做是 windows系统里的 快捷方式。</p>
<p>硬链接 就好像是 又复制了一份.</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ln</span> <span class="hljs-number">3</span>.txt <span class="hljs-number">4</span>.txt   这是硬链接，相当于复制，不可以跨分区，但修改<span class="hljs-number">3</span>,<span class="hljs-number">4</span>会跟着变，若删除<span class="hljs-number">3</span>,<span class="hljs-number">4</span>不受任何影响。<br><br><span class="hljs-attribute">ln</span> -s <span class="hljs-number">3</span>.txt <span class="hljs-number">4</span>.txt  这是软连接，相当于快捷方式。修改<span class="hljs-number">4</span>,<span class="hljs-number">3</span>也会跟着变，若删除<span class="hljs-number">3</span>,<span class="hljs-number">4</span>就坏掉了。不可以用了。<br></code></pre></td></tr></table></figure>

<h2 id="16、保存当前磁盘分区的分区表"><a href="#16、保存当前磁盘分区的分区表" class="headerlink" title="16、保存当前磁盘分区的分区表"></a><strong>16、保存当前磁盘分区的分区表</strong></h2><p>dd 命令是以个强大的命令，在复制的同时进行转换</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">dd <span class="hljs-attribute">if</span>=/dev/sda <span class="hljs-attribute">of</span>=./mbr.txt <span class="hljs-attribute">bs</span>=1 <span class="hljs-attribute">count</span>=512<br></code></pre></td></tr></table></figure>

<h2 id="17、手动安装grub"><a href="#17、手动安装grub" class="headerlink" title="17、手动安装grub"></a>17、<strong>手动安装grub</strong></h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">grub-install <span class="hljs-regexp">/dev/</span>sda<br></code></pre></td></tr></table></figure>

<h2 id="18、修改内核参数"><a href="#18、修改内核参数" class="headerlink" title="18、修改内核参数"></a><strong>18、修改内核参数</strong></h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">vi <span class="hljs-regexp">/etc/</span>sysctl.conf  这里修改参数<br>   sysctl -p  刷新后可用<br></code></pre></td></tr></table></figure>

<h2 id="19、在1-39内取随机数"><a href="#19、在1-39内取随机数" class="headerlink" title="19、在1-39内取随机数"></a><strong>19、在1-39内取随机数</strong></h2><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">expr $[$RANDOM%39] + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>RANDOM 随机数</p>
<p>%39 取余数 范围 0-38</p>
<h2 id="20、限制apache每秒新建连接数为1，峰值为3"><a href="#20、限制apache每秒新建连接数为1，峰值为3" class="headerlink" title="20、限制apache每秒新建连接数为1，峰值为3"></a>20、<strong>限制apache每秒新建连接数为1，峰值为3</strong></h2><p>每秒新建连接数 一般都是由防火墙来做，apache本身好像无法设置每秒新建连接数，只能设置最大连接：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">iptables -<span class="hljs-selector-tag">A</span> <span class="hljs-selector-tag">INPUT</span> -d <span class="hljs-number">172.16</span>.<span class="hljs-number">100.1</span> -<span class="hljs-selector-tag">p</span> tcp <span class="hljs-attr">--dport</span> <span class="hljs-number">80</span> -m limit <span class="hljs-attr">--limit</span> <span class="hljs-number">1</span>/second  -j ACCEPT<br></code></pre></td></tr></table></figure>

<p>硬件防火墙设置更简单，有界面化，可以直接填写数字。。。</p>
<p>最大连接 apache本身可以设置</p>
<p>MaxClients 3 ,修改apache最大连接 前提还是要修改系统默认tcp连接数。我博客里也说了，这就不说了。</p>
<h2 id="21、FTP的主动模式和被动模式"><a href="#21、FTP的主动模式和被动模式" class="headerlink" title="21、FTP的主动模式和被动模式"></a>21、<strong>FTP的主动模式和被动模式</strong></h2><p>FTP协议有两种工作方式：PORT方式和PASV方式，中文意思为主动式和被动式。</p>
<p>PORT（主动）方式的连接过程是：客户端向服务器的FTP端口（默认是21）发送连接请 求，服务器接受连接，建立一条命令链路。当需要传送数据时，客户端在命令链路上用PORT 命令告诉服务器：“我打开了XX端口，你过来连接我”。于是服务器从20端口向客户端的 XX端口发送连接请求，建立一条数据链路来传送数据。</p>
<p>PASV（被动）方式的连接过程是：客户端向服务器的FTP端口（默认是21）发送连接请 求，服务器接受连接，建立一条命令链路。当需要传送数据时，服务器在命令链路上用PASV 命令告诉客户端：“我打开了XX端口，你过来连接我”。于是客户端向服务器的XX端口 发送连接请求，建立一条数据链路来传送数据。</p>
<p>从上面可以看出，两种方式的命令链路连接方法是一样的，而数据链路的建立方法就完 全不同。</p>
<h2 id="22、显示-etc-inittab中以-开头，且后面跟了一个或者多个空白字符，而后又跟了任意非空白字符的行"><a href="#22、显示-etc-inittab中以-开头，且后面跟了一个或者多个空白字符，而后又跟了任意非空白字符的行" class="headerlink" title="22、显示/etc/inittab中以#开头，且后面跟了一个或者多个空白字符，而后又跟了任意非空白字符的行"></a>22、<strong>显示/etc/inittab中以#开头，且后面跟了一个或者多个空白字符，而后又跟了任意非空白字符的行</strong></h2><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;^# \&#123;1,\&#125;[^ ]&quot;</span> <span class="hljs-regexp">/etc/i</span>nittab<br></code></pre></td></tr></table></figure>

<h2 id="23、显示-etc-inittab中包含了-一个数字-即两个冒号中间一个数字-的行"><a href="#23、显示-etc-inittab中包含了-一个数字-即两个冒号中间一个数字-的行" class="headerlink" title="23、显示/etc/inittab中包含了:一个数字:(即两个冒号中间一个数字)的行"></a>23、显示/etc/inittab中包含了:一个数字:(即两个冒号中间一个数字)的行</h2><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;\:[0-9]\&#123;1\&#125;\:&quot;</span> <span class="hljs-regexp">/etc/i</span>nittab<br></code></pre></td></tr></table></figure>

<h2 id="24、怎么把脚本添加到系统服务里，即用service来调用"><a href="#24、怎么把脚本添加到系统服务里，即用service来调用" class="headerlink" title="24、怎么把脚本添加到系统服务里，即用service来调用"></a>24、<strong>怎么把脚本添加到系统服务里，即用service来调用</strong></h2><p>在脚本里加入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># chkconfig: 345 85 15</span><br><span class="hljs-comment"># description: httpd</span><br></code></pre></td></tr></table></figure>

<p>然后保存</p>
<p>chkconfig httpd –add  创建系统服务</p>
<p>现在就可以使用service 来 start or restart</p>
<h2 id="25、写一个脚本，实现批量添加20个用户，用户名为user01-20，密码为user后面跟5个随机字符"><a href="#25、写一个脚本，实现批量添加20个用户，用户名为user01-20，密码为user后面跟5个随机字符" class="headerlink" title="25、写一个脚本，实现批量添加20个用户，用户名为user01-20，密码为user后面跟5个随机字符"></a><strong>25、写一个脚本，实现批量添加20个用户，用户名为user01-20，密码为user后面跟5个随机字符</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#description: useradd</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> -f<span class="hljs-string">&quot;%02g&quot;</span> 1 20`;<span class="hljs-keyword">do</span><br>useradd user<span class="hljs-variable">$i</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;user<span class="hljs-variable">$i</span>-`echo <span class="hljs-variable">$RANDOM</span>|md5sum|cut -c 1-5`&quot;</span>|passwd –stdinuser<span class="hljs-variable">$i</span> &gt;/dev/null 2&gt;&amp;1<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>

<h2 id="26、写一个脚本，实现判断192-168-1-0-24网络里，当前在线的IP有哪些，能ping通则认为在线"><a href="#26、写一个脚本，实现判断192-168-1-0-24网络里，当前在线的IP有哪些，能ping通则认为在线" class="headerlink" title="26、写一个脚本，实现判断192.168.1.0/24网络里，当前在线的IP有哪些，能ping通则认为在线"></a><strong>26、写一个脚本，实现判断192.168.1.0/24网络里，当前在线的IP有哪些，能ping通则认为在线</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> 1 255`<br>  <span class="hljs-keyword">do</span><br>    &#123;<br>     ping -c 1 192.168.1.<span class="hljs-variable">$ip</span> &gt; /dev/null 2&gt;&amp;1<br>     <span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span><br>          <span class="hljs-built_in">echo</span> 192.168.1.<span class="hljs-variable">$ip</span> UP<br>     <span class="hljs-keyword">else</span><br>          <span class="hljs-built_in">echo</span> 192.168.1.<span class="hljs-variable">$ip</span> DOWN<br>     <span class="hljs-keyword">fi</span><br>   &#125;&amp;<br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">wait</span><br></code></pre></td></tr></table></figure>

<h2 id="26、写一个脚本，判断一个指定的脚本是否是语法错误；如果有错误，则提醒用户键入Q或者q无视错误并退出其它任何键可以通过vim打开这个指定的脚本"><a href="#26、写一个脚本，判断一个指定的脚本是否是语法错误；如果有错误，则提醒用户键入Q或者q无视错误并退出其它任何键可以通过vim打开这个指定的脚本" class="headerlink" title="26、写一个脚本，判断一个指定的脚本是否是语法错误；如果有错误，则提醒用户键入Q或者q无视错误并退出其它任何键可以通过vim打开这个指定的脚本"></a>26、<strong>写一个脚本，判断一个指定的脚本是否是语法错误；如果有错误，则提醒用户键入Q或者q无视错误并退出其它任何键可以通过vim打开这个指定的脚本</strong></h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@localhost  tmp]<span class="hljs-comment"># cat checksh.sh</span><br> <span class="hljs-comment">#!/bin/bash</span><br> read -p <span class="hljs-string">&quot;please input check script-&gt; &quot;</span> file<br> <span class="hljs-keyword">if</span> [ -f <span class="hljs-variable">$file</span> ]; then<br>    sh -n <span class="hljs-variable">$file</span> &gt; <span class="hljs-regexp">/dev/</span>null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> [ $? -ne <span class="hljs-number">0</span> ]; then<br>        read -p <span class="hljs-string">&quot;You input $file syntax error,[Type q to exit or Type vim to  edit]&quot;</span> answer<br>        case <span class="hljs-variable">$answer</span> <span class="hljs-keyword">in</span><br>        q | Q)<br>           <span class="hljs-keyword">exit</span> <span class="hljs-number">0</span><br>           ;;<br>        vim )<br>           vim <span class="hljs-variable">$file</span><br>           ;;<br>        *）<br>         <span class="hljs-keyword">exit</span> <span class="hljs-number">0</span><br>         ;;<br>        esac<br>   fi<br> <span class="hljs-keyword">else</span><br>    echo <span class="hljs-string">&quot;$file not exist&quot;</span><br>    <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span><br> fi<br></code></pre></td></tr></table></figure>

<h2 id="27、写一个脚本：-27包括3个小题"><a href="#27、写一个脚本：-27包括3个小题" class="headerlink" title="27、写一个脚本：(27包括3个小题)"></a><strong>27、写一个脚本：(27包括3个小题)</strong></h2><p>1、创建一个函数，能接受两个参数：</p>
<p>1)第一个参数为URL，即可下载的文件；第二个参数为目录，即下载后保存的位置；</p>
<p>2)如果用户给的目录不存在，则提示用户是否创建；如果创建就继续执行，否则，函数返回一个51的错误值给调用脚本；</p>
<p>3)如果给的目录存在，则下载文件；下载命令执行结束后测试文件下载成功与否；如果成功，则返回0给调用脚本，否则，返回52给调用脚本；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost tmp]<span class="hljs-comment"># cat downfile.sh</span><br><span class="hljs-comment">#!/bin/bash</span><br>url=<span class="hljs-variable">$1</span><br><span class="hljs-built_in">dir</span>=<span class="hljs-variable">$2</span><br><span class="hljs-function"><span class="hljs-title">download</span></span>()<br>  &#123;<br>    <span class="hljs-built_in">cd</span> <span class="hljs-variable">$dir</span> &gt;&gt; /dev/null 2&gt;&amp;1<br>    <span class="hljs-keyword">if</span> [ $? -ne 0 ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;<span class="hljs-variable">$dir</span> No such file or directory,create?(y/n)&quot;</span> answer<br>        <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$answer</span>&quot;</span> == <span class="hljs-string">&quot;y&quot;</span> ];<span class="hljs-keyword">then</span><br>            <span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$dir</span><br>            <span class="hljs-built_in">cd</span> <span class="hljs-variable">$dir</span><br>            wget <span class="hljs-variable">$url</span> 1&gt; /dev/null 2&gt;&amp;1<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;51&quot;</span><br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">if</span> [ $? -ne 0 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;52&quot;</span><br>    <span class="hljs-keyword">fi</span><br>&#125;<br>download <span class="hljs-variable">$url</span> <span class="hljs-variable">$dir</span><br><span class="hljs-built_in">echo</span> $?<br></code></pre></td></tr></table></figure>



<h2 id="28、写一个脚本：（28包括2个小题）"><a href="#28、写一个脚本：（28包括2个小题）" class="headerlink" title="28、写一个脚本：（28包括2个小题）"></a><strong>28、写一个脚本：（28包括2个小题）</strong></h2><p>1、创建一个函数，可以接受一个磁盘设备路径（如/dev/sdb）作为参数;在真正开始后面步骤之前提醒用户有危险，并让用户选择是否继续；而后将此磁盘设备上的所有分区清空（提示，使用命令dd if=/dev/zero of=/dev/sdb bs=512 count=1实现，注意其中的设备路径不要写错了；</p>
<p>如果此步骤失败，返回67给主程序；</p>
<p>接着在此磁盘设备上创建两个主分区，一个大小为100M，一个大小为1G；如果此步骤失败，返回68给主程序；<br>格式化此两分区，文件系统类型为ext3；如果此步骤失败，返回69给主程序；</p>
<p>如果上述过程都正常，返回0给主程序；</p>
<p>2、调用此函数；并通过接收函数执行的返回值来判断其执行情况，并将信息显示出来；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">local</span> Darray=(`<span class="hljs-built_in">ls</span> /dev/sd[a-z]`)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;Darray&#125;</span>;<span class="hljs-keyword">do</span><br>  [[ <span class="hljs-string">&quot;<span class="hljs-variable">$i</span>&quot;</span> == <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ]] &amp;&amp; Sd=<span class="hljs-variable">$i</span> &amp;&amp;<span class="hljs-built_in">break</span><br><span class="hljs-keyword">done</span><br>  <span class="hljs-keyword">else</span><br>  return66<br>  <span class="hljs-keyword">fi</span><br><span class="hljs-comment">#当匹配成功，进入选择，告诉用户，是否继续，输错的话进入无限循环，当用户选择Y,则清空目标分区，且跳出while循环</span><br><span class="hljs-keyword">while</span> :;<span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;Warning!!!This operation will clean <span class="hljs-variable">$Sd</span> data.Next=y,Quit=n [y|n]:&quot;</span> Choice<br>    <span class="hljs-keyword">case</span> <span class="hljs-variable">$Choice</span> <span class="hljs-keyword">in</span><br>y)<br>   <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/zero of=<span class="hljs-variable">$Sd</span> bs=512 count=1 &amp;&gt; /dev/null &amp;&amp;<span class="hljs-built_in">break</span> || <span class="hljs-built_in">return</span> 67 ;;<br>n)<br>   <span class="hljs-built_in">exit</span> 88 ;;<br>*)<br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Invalid choice,please choice again.&quot;</span> ;;<br><span class="hljs-keyword">esac</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>

<p>#使用echo传递给fdisk进行分区，如果此命令失败，则跳转出去，错误值68，需要注意的是，有时候这个返回值很诡异，笔者之前成功与否都是返回的1，后来重启之后，就好了，如果慎重的话，可以对创建的分区，进行判断，不过就需要使用其他工具截取相关字段了，虽有些小麻烦，但无大碍</p>
<figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-variable">echo</span><span class="hljs-operator">-</span><span class="hljs-variable">e</span> <span class="hljs-string">&quot;n<span class="hljs-char escape_">\n</span>p<span class="hljs-char escape_">\n</span>1<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span>+100M<span class="hljs-char escape_">\n</span>n<span class="hljs-char escape_">\n</span>p<span class="hljs-char escape_">\n</span>2<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span>+1024M<span class="hljs-char escape_">\n</span>w<span class="hljs-char escape_">\n</span>&quot;</span><span class="hljs-operator">|</span><span class="hljs-variable">fdisk</span> /<span class="hljs-variable">dev</span>/<span class="hljs-variable">sdb</span><span class="hljs-operator">&amp;</span><span class="hljs-operator">&gt;</span> /<span class="hljs-variable">dev</span>/<span class="hljs-literal">null</span> <span class="hljs-operator">||</span> <span class="hljs-keyword">return</span> <span class="hljs-number">68</span><br></code></pre></td></tr></table></figure>

<p>#格式化之前，让内核重新读取磁盘分区表，值得注意的是，有的系统版本，使用partprobe无效，譬如笔者的环境是rhel5.8，而rhel6.0以后，这个命令就很危险了，而使用partx -a /dev/sdb则效果更好…此项需慎重，如果格式化失败，则告知把失败的分区定义成变量，且跳出函数，并带出错误值69</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">`partprobe`<br>Part=`fdisk -l /dev/<span class="hljs-variable">$Sd</span>|<span class="hljs-built_in">tail</span> -2|<span class="hljs-built_in">cut</span> -d” ” -f1`<br><span class="hljs-keyword">for</span> M <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;Part&#125;</span>;<span class="hljs-keyword">do</span><br>   mke2fs -j <span class="hljs-variable">$M</span> &amp;&gt; /dev/null &amp;&amp; ErrorPart=<span class="hljs-variable">$M</span> &amp;&amp;<span class="hljs-built_in">return</span> 69<br><span class="hljs-keyword">done</span><br>  <span class="hljs-built_in">return</span> 0<br>&#125;<br></code></pre></td></tr></table></figure>

<p>#下面代码，调用函数，接收函数返回值，根据返回值进行判断哪里出错。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">Disk_Mod <span class="hljs-variable">$1</span><br>Res=$?<br>[ <span class="hljs-variable">$Res</span>-eq <span class="hljs-number">0</span> ] &amp;&amp; <span class="hljs-keyword">exit</span> <span class="hljs-number">0</span><br>[ <span class="hljs-variable">$Res</span>-eq <span class="hljs-number">66</span> ] &amp;&amp; echo <span class="hljs-string">&quot;Error! Invalid input.&quot;</span><br>[ <span class="hljs-variable">$Res</span>-eq <span class="hljs-number">67</span> ] &amp;&amp; echo <span class="hljs-string">&quot;Error! Command -&gt; dd &lt;- Faild.&quot;</span><br>[ <span class="hljs-variable">$Res</span>-eq <span class="hljs-number">68</span> ] &amp;&amp; echo <span class="hljs-string">&quot;Error! Command -&gt; fdisk &lt;- Faild.&quot;</span><br>[ <span class="hljs-variable">$Res</span>-eq <span class="hljs-number">69</span> ] &amp;&amp; echo <span class="hljs-string">&quot;Error! Command -&gt; mke2fs &lt;- Faild.&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="29、统计指定aaa目录的文件大于1M的txt文件个数"><a href="#29、统计指定aaa目录的文件大于1M的txt文件个数" class="headerlink" title="29、统计指定aaa目录的文件大于1M的txt文件个数"></a>29、统计指定aaa目录的文件大于1M的txt文件个数</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@tiejiang</span> ~]# find aaa -name <span class="hljs-string">&quot;*.txt&quot;</span> -<span class="hljs-keyword">type</span> f -size <span class="hljs-number">+1024000</span><span class="hljs-keyword">c</span> | wc -l<br></code></pre></td></tr></table></figure>

<h2 id="30、打印使用率大于85-的分区"><a href="#30、打印使用率大于85-的分区" class="headerlink" title="30、打印使用率大于85%的分区"></a>30、打印使用率大于85%的分区</h2><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@tiejiang</span> ~]<span class="hljs-meta"># df -h | awk <span class="hljs-string">&#x27;+$5&gt;85&#x27;</span></span><br></code></pre></td></tr></table></figure>

<h2 id="31、统计出apache的access-log中访问量最多的5个IP"><a href="#31、统计出apache的access-log中访问量最多的5个IP" class="headerlink" title="31、统计出apache的access.log中访问量最多的5个IP"></a>31、统计出apache的access.log中访问量最多的5个IP</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@tiejiang ~]# <span class="hljs-keyword">cat</span> access.<span class="hljs-keyword">log</span> | awk &#x27;&#123;a[<span class="hljs-variable">$1</span>]++&#125;END&#123;<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> a)<span class="hljs-keyword">print</span> i,a[i] |<span class="hljs-string">&quot;sort -n -r -k 2&quot;</span>&#125;&#x27; | head -5<br></code></pre></td></tr></table></figure>

<h2 id="32、检测并修复-dev-hda5"><a href="#32、检测并修复-dev-hda5" class="headerlink" title="32、检测并修复/dev/hda5"></a>32、检测并修复/dev/hda5</h2><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@tiejiang</span> ~]<span class="hljs-meta"># e2fsck -p /dev/hda5</span><br></code></pre></td></tr></table></figure>

<h2 id="33、符号链接和硬链接的区别"><a href="#33、符号链接和硬链接的区别" class="headerlink" title="33、符号链接和硬链接的区别"></a>33、符号链接和硬链接的区别</h2><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs erlang">硬链接:不同路径的文件指定的是同一个inode<br>     硬链接不能跨分区存在<br>     硬链接不能链接到目录(要避免循环引用)<br>     删除硬链接只会减少文件被硬链接的次数,源文件不会动.<br>软链接:是一个独立的文件,有自己独立的inode<br>     引用的是路径本身,不是inode<br>     删除软链接,跟源文件没任何关系<br>     软链接没有存储任何数据,只是存储了访问文件的另一种路径.<br>     软链接可以对目录创建,也可以跨分区<br>     源文件被删除,软连接将不可用.<br></code></pre></td></tr></table></figure>

<h2 id="34、在取一个100以内的随机数指定范围内取随机数，语言不限，越短越好"><a href="#34、在取一个100以内的随机数指定范围内取随机数，语言不限，越短越好" class="headerlink" title="34、在取一个100以内的随机数指定范围内取随机数，语言不限，越短越好"></a>34、在取一个100以内的随机数指定范围内取随机数，语言不限，越短越好</h2><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">[root@tiejiang ~]# echo $[$RANDOM%100]<br></code></pre></td></tr></table></figure>








            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/07/28/Linux%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%8810%E4%B8%AA%E5%9F%BA%E6%9C%AC%E6%8A%80%E8%83%BD%E7%82%B9/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Linux运维工程师10个基本技能点</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/07/28/Centos7-8%E9%83%A8%E7%BD%B2mysql%E4%B8%8ENacos-2-0-3/">
                        <span class="hidden-mobile">Centos7.8部署mysql与Nacos-2.0.3</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://qm.qq.com/cgi-bin/qm/qr?k=A5I1aDMT5p5nmi3zDa8t7gWOHawJhjyi&noverify=0&personal_qrcode_source=4" target="_blank" rel="nofollow noopener"><span>JohnBakcu</span></a> <i class="iconfont icon-love"></i> <a href="https://www.magedu.com"  target="_blank" rel="nofollow noopener"><span>Mgedu</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
